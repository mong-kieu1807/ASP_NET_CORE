@using SportsStore.Domain.Models
@model IEnumerable<Product>
@{
    ViewData["Title"] = "Danh sách sản phẩm";
    int itemsPerPage = ViewBag.ItemsPerPage > 0 ? (int)ViewBag.ItemsPerPage : 1;
    int totalPages = (int)Math.Ceiling((decimal)ViewBag.TotalItems / itemsPerPage);
    string currentCategory = ViewBag.CurrentCategory as string ?? "";
    int currentPage = ViewBag.CurrentPage ?? 1;
    var categories = ViewBag.Categories as IEnumerable<string>;
}
<h1 class="text-center my-4">@ViewData["Title"]</h1>
@if (!string.IsNullOrEmpty(ViewBag.CurrentCategory) && ViewBag.CurrentCategory != "Tất cả sản phẩm")
{
    <h2 class="text-primary">Danh mục: @ViewBag.CurrentCategory</h2>
}
<div class="row">
    <!-- Sidebar -->
    <div class="col-md-3">
        <h3>Danh mục</h3>
        <div class="list-group">
            <a asp-action="List" asp-controller="Product" asp-route-category=""
               class="list-group-item list-group-item-action
                @(string.IsNullOrWhiteSpace(currentCategory) ? "active" : "")">
               Tất cả sản phẩm
           </a>
           @foreach (var category in categories)
           {
               <a asp-action="List" asp-controller="Product" asp-route-category="@category" class="list-group-item list-group-item-action
                @(category == currentCategory ? "active" : "")">
                @category
                </a>
            }
        </div>
    </div>
    <!-- Main content -->
    <div class="col-md-9">
        @if (Model?.Any() == true)
        {
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            @foreach (var p in Model)
            {
                <partial name="_ProductCard" model="p" />
            }
            </div>
            <!-- Pagination -->
            <nav aria-label="Phân trang" class="mt-4">
                <ul class="pagination justify-content-center">
                    @for (int i = 1; i <= totalPages; i++)
                    {
                        <li class="page-item @(i == currentPage ? "active" : "")">
                            <a class="page-link" 
                               asp-controller="Product" 
                               asp-action="List" 
                               asp-route-productPage="@i">@i</a>
                        </li>
                    }
                </ul>
            </nav>
        }
        else
        {
            <div class="alert alert-warning text-center" role="alert">
                Không tìm thấy sản phẩm nào trong danh mục này.
            </div>
        }
    </div>
</div>
@section Scripts {
    <script src="https://kit.fontawesome.com/your-font-awesome-kit.js" crossorigin="anonymous"></script>
}


